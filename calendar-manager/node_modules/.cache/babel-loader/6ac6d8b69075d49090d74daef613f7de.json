{"ast":null,"code":"import * as React from 'react';\nimport { SuspenseSubject } from './SuspenseSubject';\nvar PRELOADED_OBSERVABLES = '_reactFirePreloadedObservables';\nvar DEFAULT_TIMEOUT = 30000;\nvar preloadedObservables = globalThis[PRELOADED_OBSERVABLES] || new Map();\n\nif (!globalThis[PRELOADED_OBSERVABLES]) {\n  globalThis[PRELOADED_OBSERVABLES] = preloadedObservables;\n}\n\nexport function preloadObservable(source, id) {\n  if (preloadedObservables.has(id)) {\n    return preloadedObservables.get(id);\n  } else {\n    var observable = new SuspenseSubject(source, DEFAULT_TIMEOUT);\n    preloadedObservables.set(id, observable);\n    return observable;\n  }\n}\nexport function useObservable(source, observableId, startWithValue, deps) {\n  if (deps === void 0) {\n    deps = [observableId];\n  }\n\n  if (!observableId) {\n    throw new Error('cannot call useObservable without an observableId');\n  }\n\n  var observable = preloadObservable(source, observableId);\n\n  if (!observable.hasValue && !startWithValue) {\n    throw observable.firstEmission;\n  }\n\n  var _a = React.useState(function () {\n    return observable.hasValue ? observable.value : startWithValue;\n  }),\n      latest = _a[0],\n      setValue = _a[1];\n\n  React.useEffect(function () {\n    var subscription = observable.subscribe(function (v) {\n      return setValue(function () {\n        return v;\n      });\n    }, function (e) {\n      throw e;\n    });\n    return function () {\n      return subscription.unsubscribe();\n    };\n  }, deps);\n  return latest;\n}","map":{"version":3,"sources":["/Users/shiyuezhang/Desktop/myFiles/Chronolo-Geese/calendar-manager/node_modules/reactfire/useObservable/index.js"],"names":["React","SuspenseSubject","PRELOADED_OBSERVABLES","DEFAULT_TIMEOUT","preloadedObservables","globalThis","Map","preloadObservable","source","id","has","get","observable","set","useObservable","observableId","startWithValue","deps","Error","hasValue","firstEmission","_a","useState","value","latest","setValue","useEffect","subscription","subscribe","v","e","unsubscribe"],"mappings":"AAAA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,SAASC,eAAT,QAAgC,mBAAhC;AACA,IAAIC,qBAAqB,GAAG,gCAA5B;AACA,IAAIC,eAAe,GAAG,KAAtB;AACA,IAAIC,oBAAoB,GAAGC,UAAU,CAACH,qBAAD,CAAV,IAAqC,IAAII,GAAJ,EAAhE;;AACA,IAAI,CAACD,UAAU,CAACH,qBAAD,CAAf,EAAwC;AACpCG,EAAAA,UAAU,CAACH,qBAAD,CAAV,GAAoCE,oBAApC;AACH;;AACD,OAAO,SAASG,iBAAT,CAA2BC,MAA3B,EAAmCC,EAAnC,EAAuC;AAC1C,MAAIL,oBAAoB,CAACM,GAArB,CAAyBD,EAAzB,CAAJ,EAAkC;AAC9B,WAAOL,oBAAoB,CAACO,GAArB,CAAyBF,EAAzB,CAAP;AACH,GAFD,MAGK;AACD,QAAIG,UAAU,GAAG,IAAIX,eAAJ,CAAoBO,MAApB,EAA4BL,eAA5B,CAAjB;AACAC,IAAAA,oBAAoB,CAACS,GAArB,CAAyBJ,EAAzB,EAA6BG,UAA7B;AACA,WAAOA,UAAP;AACH;AACJ;AACD,OAAO,SAASE,aAAT,CAAuBN,MAAvB,EAA+BO,YAA/B,EAA6CC,cAA7C,EAA6DC,IAA7D,EAAmE;AACtE,MAAIA,IAAI,KAAK,KAAK,CAAlB,EAAqB;AAAEA,IAAAA,IAAI,GAAG,CAACF,YAAD,CAAP;AAAwB;;AAC/C,MAAI,CAACA,YAAL,EAAmB;AACf,UAAM,IAAIG,KAAJ,CAAU,mDAAV,CAAN;AACH;;AACD,MAAIN,UAAU,GAAGL,iBAAiB,CAACC,MAAD,EAASO,YAAT,CAAlC;;AACA,MAAI,CAACH,UAAU,CAACO,QAAZ,IAAwB,CAACH,cAA7B,EAA6C;AACzC,UAAMJ,UAAU,CAACQ,aAAjB;AACH;;AACD,MAAIC,EAAE,GAAGrB,KAAK,CAACsB,QAAN,CAAe,YAAY;AAAE,WAAQV,UAAU,CAACO,QAAX,GAAsBP,UAAU,CAACW,KAAjC,GAAyCP,cAAjD;AAAmE,GAAhG,CAAT;AAAA,MAA4GQ,MAAM,GAAGH,EAAE,CAAC,CAAD,CAAvH;AAAA,MAA4HI,QAAQ,GAAGJ,EAAE,CAAC,CAAD,CAAzI;;AACArB,EAAAA,KAAK,CAAC0B,SAAN,CAAgB,YAAY;AACxB,QAAIC,YAAY,GAAGf,UAAU,CAACgB,SAAX,CAAqB,UAAUC,CAAV,EAAa;AAAE,aAAOJ,QAAQ,CAAC,YAAY;AAAE,eAAOI,CAAP;AAAW,OAA1B,CAAf;AAA6C,KAAjF,EAAmF,UAAUC,CAAV,EAAa;AAC/G,YAAMA,CAAN;AACH,KAFkB,CAAnB;AAGA,WAAO,YAAY;AAAE,aAAOH,YAAY,CAACI,WAAb,EAAP;AAAoC,KAAzD;AACH,GALD,EAKGd,IALH;AAMA,SAAOO,MAAP;AACH","sourcesContent":["import * as React from 'react';\nimport { SuspenseSubject } from './SuspenseSubject';\nvar PRELOADED_OBSERVABLES = '_reactFirePreloadedObservables';\nvar DEFAULT_TIMEOUT = 30000;\nvar preloadedObservables = globalThis[PRELOADED_OBSERVABLES] || new Map();\nif (!globalThis[PRELOADED_OBSERVABLES]) {\n    globalThis[PRELOADED_OBSERVABLES] = preloadedObservables;\n}\nexport function preloadObservable(source, id) {\n    if (preloadedObservables.has(id)) {\n        return preloadedObservables.get(id);\n    }\n    else {\n        var observable = new SuspenseSubject(source, DEFAULT_TIMEOUT);\n        preloadedObservables.set(id, observable);\n        return observable;\n    }\n}\nexport function useObservable(source, observableId, startWithValue, deps) {\n    if (deps === void 0) { deps = [observableId]; }\n    if (!observableId) {\n        throw new Error('cannot call useObservable without an observableId');\n    }\n    var observable = preloadObservable(source, observableId);\n    if (!observable.hasValue && !startWithValue) {\n        throw observable.firstEmission;\n    }\n    var _a = React.useState(function () { return (observable.hasValue ? observable.value : startWithValue); }), latest = _a[0], setValue = _a[1];\n    React.useEffect(function () {\n        var subscription = observable.subscribe(function (v) { return setValue(function () { return v; }); }, function (e) {\n            throw e;\n        });\n        return function () { return subscription.unsubscribe(); };\n    }, deps);\n    return latest;\n}\n"]},"metadata":{},"sourceType":"module"}