{"ast":null,"code":"'use strict';\n\nexports.__esModule = true;\nexports.preventScroll = exports.GridCell = undefined;\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nvar _styledComponents = require('styled-components');\n\nvar _styledComponents2 = _interopRequireDefault(_styledComponents);\n\nvar _add_minutes = require('date-fns/add_minutes');\n\nvar _add_minutes2 = _interopRequireDefault(_add_minutes);\n\nvar _add_hours = require('date-fns/add_hours');\n\nvar _add_hours2 = _interopRequireDefault(_add_hours);\n\nvar _add_days = require('date-fns/add_days');\n\nvar _add_days2 = _interopRequireDefault(_add_days);\n\nvar _start_of_day = require('date-fns/start_of_day');\n\nvar _start_of_day2 = _interopRequireDefault(_start_of_day);\n\nvar _is_same_minute = require('date-fns/is_same_minute');\n\nvar _is_same_minute2 = _interopRequireDefault(_is_same_minute);\n\nvar _format = require('date-fns/format');\n\nvar _format2 = _interopRequireDefault(_format);\n\nvar _typography = require('./typography');\n\nvar _colors = require('./colors');\n\nvar _colors2 = _interopRequireDefault(_colors);\n\nvar _selectionSchemes = require('./selection-schemes');\n\nvar _selectionSchemes2 = _interopRequireDefault(_selectionSchemes);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  } else {\n    var newObj = {};\n\n    if (obj != null) {\n      for (var key in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n      }\n    }\n\n    newObj.default = obj;\n    return newObj;\n  }\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n} // Import only the methods we need from date-fns in order to keep build size small\n\n\nvar Wrapper = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__Wrapper',\n  componentId: 'sc-10qe3m2-0'\n})(['display:flex;align-items:center;width:100%;user-select:none;']);\n\nvar Grid = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__Grid',\n  componentId: 'sc-10qe3m2-1'\n})(['display:flex;flex-direction:row;align-items:stretch;width:100%;']);\n\nvar Column = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__Column',\n  componentId: 'sc-10qe3m2-2'\n})(['display:flex;flex-direction:column;justify-content:space-evenly;flex-grow:1;']);\n\nvar GridCell = exports.GridCell = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__GridCell',\n  componentId: 'sc-10qe3m2-3'\n})(['margin:', 'px;touch-action:none;'], function (props) {\n  return props.margin;\n});\n\nvar DateCell = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__DateCell',\n  componentId: 'sc-10qe3m2-4'\n})(['width:100%;height:25px;background-color:', ';&:hover{background-color:', ';}'], function (props) {\n  return props.selected ? props.selectedColor : props.unselectedColor;\n}, function (props) {\n  return props.hoveredColor;\n});\n\nvar DateLabel = (0, _styledComponents2.default)(_typography.Subtitle).withConfig({\n  displayName: 'ScheduleSelector__DateLabel',\n  componentId: 'sc-10qe3m2-5'\n})(['height:30px;@media (max-width:699px){font-size:12px;}']);\n\nvar TimeLabelCell = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__TimeLabelCell',\n  componentId: 'sc-10qe3m2-6'\n})(['position:relative;display:block;width:100%;height:25px;margin:3px 0;text-align:center;display:flex;justify-content:center;align-items:center;']);\n\nvar TimeText = (0, _styledComponents2.default)(_typography.Text).withConfig({\n  displayName: 'ScheduleSelector__TimeText',\n  componentId: 'sc-10qe3m2-7'\n})(['margin:0;@media (max-width:699px){font-size:10px;}text-align:right;']);\n\nvar preventScroll = exports.preventScroll = function preventScroll(e) {\n  e.preventDefault();\n};\n\nvar ScheduleSelector = function (_React$Component) {\n  _inherits(ScheduleSelector, _React$Component);\n\n  ScheduleSelector.getDerivedStateFromProps = function getDerivedStateFromProps(props, state) {\n    // As long as the user isn't in the process of selecting, allow prop changes to re-populate selection state\n    if (state.selectionStart == null) {\n      return {\n        selection: [].concat(props.selection)\n      };\n    }\n\n    return null;\n  };\n\n  function ScheduleSelector(props) {\n    _classCallCheck(this, ScheduleSelector); // Generate list of dates to render cells for\n\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _this.renderTimeLabels = function () {\n      var labels = [React.createElement(DateLabel, {\n        key: -1\n      })]; // Ensures time labels start at correct location\n\n      _this.dates[0].forEach(function (time) {\n        labels.push(React.createElement(TimeLabelCell, {\n          key: time.toString()\n        }, React.createElement(TimeText, null, (0, _format2.default)(time, _this.props.timeFormat))));\n      });\n\n      return React.createElement(Column, {\n        margin: _this.props.margin\n      }, labels);\n    };\n\n    _this.renderDateColumn = function (dayOfTimes) {\n      return React.createElement(Column, {\n        key: dayOfTimes[0].toString(),\n        margin: _this.props.margin\n      }, React.createElement(GridCell, {\n        margin: _this.props.margin\n      }, React.createElement(DateLabel, null, (0, _format2.default)(dayOfTimes[0], _this.props.dateFormat))), dayOfTimes.map(function (time) {\n        return _this.renderDateCellWrapper(time);\n      }));\n    };\n\n    _this.renderDateCellWrapper = function (time) {\n      var startHandler = function startHandler() {\n        _this.handleSelectionStartEvent(time);\n      };\n\n      var selected = Boolean(_this.state.selectionDraft.find(function (a) {\n        return (0, _is_same_minute2.default)(a, time);\n      }));\n      return React.createElement(GridCell, {\n        className: 'rgdp__grid-cell',\n        role: 'presentation',\n        margin: _this.props.margin,\n        key: time.toISOString() // Mouse handlers\n        ,\n        onMouseDown: startHandler,\n        onMouseEnter: function onMouseEnter() {\n          _this.handleMouseEnterEvent(time);\n        },\n        onMouseUp: function onMouseUp() {\n          _this.handleMouseUpEvent(time);\n        } // Touch handlers\n        // Since touch events fire on the event where the touch-drag started, there's no point in passing\n        // in the time parameter, instead these handlers will do their job using the default SyntheticEvent\n        // parameters\n        ,\n        onTouchStart: startHandler,\n        onTouchMove: _this.handleTouchMoveEvent,\n        onTouchEnd: _this.handleTouchEndEvent\n      }, _this.renderDateCell(time, selected));\n    };\n\n    _this.renderDateCell = function (time, selected) {\n      var refSetter = function refSetter(dateCell) {\n        if (dateCell) {\n          _this.cellToDate.set(dateCell, time);\n        }\n      };\n\n      if (_this.props.renderDateCell) {\n        return _this.props.renderDateCell(time, selected, refSetter);\n      } else {\n        return React.createElement(DateCell, {\n          selected: selected,\n          ref: refSetter,\n          selectedColor: _this.props.selectedColor,\n          unselectedColor: _this.props.unselectedColor,\n          hoveredColor: _this.props.hoveredColor\n        });\n      }\n    };\n\n    var startTime = (0, _start_of_day2.default)(props.startDate);\n    _this.dates = [];\n    _this.cellToDate = new Map();\n    var minutesInChunk = Math.floor(60 / props.hourlyChunks);\n\n    for (var d = 0; d < props.numDays; d += 1) {\n      var currentDay = [];\n\n      for (var h = props.minTime; h < props.maxTime; h += 1) {\n        for (var c = 0; c < props.hourlyChunks; c += 1) {\n          currentDay.push((0, _add_minutes2.default)((0, _add_hours2.default)((0, _add_days2.default)(startTime, d), h), c * minutesInChunk));\n        }\n      }\n\n      _this.dates.push(currentDay);\n    }\n\n    _this.state = {\n      selectionDraft: [].concat(_this.props.selection),\n      // copy it over\n      selectionType: null,\n      selectionStart: null,\n      isTouchDragging: false\n    };\n    _this.selectionSchemeHandlers = {\n      linear: _selectionSchemes2.default.linear,\n      square: _selectionSchemes2.default.square\n    };\n    _this.endSelection = _this.endSelection.bind(_this);\n    _this.handleMouseUpEvent = _this.handleMouseUpEvent.bind(_this);\n    _this.handleMouseEnterEvent = _this.handleMouseEnterEvent.bind(_this);\n    _this.handleTouchMoveEvent = _this.handleTouchMoveEvent.bind(_this);\n    _this.handleTouchEndEvent = _this.handleTouchEndEvent.bind(_this);\n    _this.handleSelectionStartEvent = _this.handleSelectionStartEvent.bind(_this);\n    return _this;\n  }\n\n  ScheduleSelector.prototype.componentDidMount = function componentDidMount() {\n    // We need to add the endSelection event listener to the document itself in order\n    // to catch the cases where the users ends their mouse-click somewhere besides\n    // the date cells (in which case none of the DateCell's onMouseUp handlers would fire)\n    //\n    // This isn't necessary for touch events since the `touchend` event fires on\n    // the element where the touch/drag started so it's always caught.\n    document.addEventListener('mouseup', this.endSelection); // Prevent page scrolling when user is dragging on the date cells\n\n    this.cellToDate.forEach(function (value, dateCell) {\n      if (dateCell && dateCell.addEventListener) {\n        dateCell.addEventListener('touchmove', preventScroll, {\n          passive: false\n        });\n      }\n    });\n  };\n\n  ScheduleSelector.prototype.componentWillUnmount = function componentWillUnmount() {\n    document.removeEventListener('mouseup', this.endSelection);\n    this.cellToDate.forEach(function (value, dateCell) {\n      if (dateCell && dateCell.removeEventListener) {\n        dateCell.removeEventListener('touchmove', preventScroll);\n      }\n    });\n  }; // Performs a lookup into this.cellToDate to retrieve the Date that corresponds to\n  // the cell where this touch event is right now. Note that this method will only work\n  // if the event is a `touchmove` event since it's the only one that has a `touches` list.\n\n\n  ScheduleSelector.prototype.getTimeFromTouchEvent = function getTimeFromTouchEvent(event) {\n    var touches = event.touches;\n    if (!touches || touches.length === 0) return null;\n    var _touches$ = touches[0],\n        clientX = _touches$.clientX,\n        clientY = _touches$.clientY;\n    var targetElement = document.elementFromPoint(clientX, clientY);\n\n    if (targetElement) {\n      var cellTime = this.cellToDate.get(targetElement);\n      return cellTime;\n    }\n\n    return null;\n  };\n\n  ScheduleSelector.prototype.endSelection = function endSelection() {\n    this.props.onChange(this.state.selectionDraft);\n    this.setState({\n      selectionType: null,\n      selectionStart: null\n    });\n  }; // Given an ending Date, determines all the dates that should be selected in this draft\n\n\n  ScheduleSelector.prototype.updateAvailabilityDraft = function updateAvailabilityDraft(selectionEnd, callback) {\n    var _state = this.state,\n        selectionType = _state.selectionType,\n        selectionStart = _state.selectionStart;\n    if (selectionType === null || selectionStart === null) return;\n    var newSelection = [];\n\n    if (selectionStart && selectionEnd && selectionType) {\n      newSelection = this.selectionSchemeHandlers[this.props.selectionScheme](selectionStart, selectionEnd, this.dates);\n    }\n\n    var nextDraft = [].concat(this.props.selection);\n\n    if (selectionType === 'add') {\n      nextDraft = Array.from(new Set([].concat(nextDraft, newSelection)));\n    } else if (selectionType === 'remove') {\n      nextDraft = nextDraft.filter(function (a) {\n        return !newSelection.find(function (b) {\n          return (0, _is_same_minute2.default)(a, b);\n        });\n      });\n    }\n\n    this.setState({\n      selectionDraft: nextDraft\n    }, callback);\n  }; // Isomorphic (mouse and touch) handler since starting a selection works the same way for both classes of user input\n\n\n  ScheduleSelector.prototype.handleSelectionStartEvent = function handleSelectionStartEvent(startTime) {\n    // Check if the startTime cell is selected/unselected to determine if this drag-select should\n    // add values or remove values\n    var timeSelected = this.props.selection.find(function (a) {\n      return (0, _is_same_minute2.default)(a, startTime);\n    });\n    this.setState({\n      selectionType: timeSelected ? 'remove' : 'add',\n      selectionStart: startTime\n    });\n  };\n\n  ScheduleSelector.prototype.handleMouseEnterEvent = function handleMouseEnterEvent(time) {\n    // Need to update selection draft on mouseup as well in order to catch the cases\n    // where the user just clicks on a single cell (because no mouseenter events fire\n    // in this scenario)\n    this.updateAvailabilityDraft(time);\n  };\n\n  ScheduleSelector.prototype.handleMouseUpEvent = function handleMouseUpEvent(time) {\n    this.updateAvailabilityDraft(time); // Don't call this.endSelection() here because the document mouseup handler will do it\n  };\n\n  ScheduleSelector.prototype.handleTouchMoveEvent = function handleTouchMoveEvent(event) {\n    this.setState({\n      isTouchDragging: true\n    });\n    var cellTime = this.getTimeFromTouchEvent(event);\n\n    if (cellTime) {\n      this.updateAvailabilityDraft(cellTime);\n    }\n  };\n\n  ScheduleSelector.prototype.handleTouchEndEvent = function handleTouchEndEvent() {\n    var _this2 = this;\n\n    if (!this.state.isTouchDragging) {\n      // Going down this branch means the user tapped but didn't drag -- which\n      // means the availability draft hasn't yet been updated (since\n      // handleTouchMoveEvent was never called) so we need to do it now\n      this.updateAvailabilityDraft(null, function () {\n        _this2.endSelection();\n      });\n    } else {\n      this.endSelection();\n    }\n\n    this.setState({\n      isTouchDragging: false\n    });\n  };\n\n  ScheduleSelector.prototype.render = function render() {\n    var _this3 = this;\n\n    return React.createElement(Wrapper, null, React.createElement(Grid, {\n      ref: function ref(el) {\n        _this3.gridRef = el;\n      }\n    }, this.renderTimeLabels(), this.dates.map(this.renderDateColumn)));\n  };\n\n  return ScheduleSelector;\n}(React.Component);\n\nScheduleSelector.defaultProps = {\n  selection: [],\n  selectionScheme: 'square',\n  numDays: 7,\n  minTime: 9,\n  maxTime: 23,\n  hourlyChunks: 1,\n  startDate: new Date(),\n  timeFormat: 'ha',\n  dateFormat: 'M/D',\n  margin: 3,\n  selectedColor: _colors2.default.blue,\n  unselectedColor: _colors2.default.paleBlue,\n  hoveredColor: _colors2.default.lightBlue,\n  onChange: function onChange() {}\n};\nexports.default = ScheduleSelector;","map":{"version":3,"sources":["/Users/shiyuezhang/Desktop/myFiles/Chronolo-Geese/calendar-manager/node_modules/react-schedule-selector/dist/lib/ScheduleSelector.js"],"names":["exports","__esModule","preventScroll","GridCell","undefined","_react","require","React","_interopRequireWildcard","_styledComponents","_styledComponents2","_interopRequireDefault","_add_minutes","_add_minutes2","_add_hours","_add_hours2","_add_days","_add_days2","_start_of_day","_start_of_day2","_is_same_minute","_is_same_minute2","_format","_format2","_typography","_colors","_colors2","_selectionSchemes","_selectionSchemes2","obj","default","newObj","key","Object","prototype","hasOwnProperty","call","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","Wrapper","div","withConfig","displayName","componentId","Grid","Column","props","margin","DateCell","selected","selectedColor","unselectedColor","hoveredColor","DateLabel","Subtitle","TimeLabelCell","TimeText","Text","e","preventDefault","ScheduleSelector","_React$Component","getDerivedStateFromProps","state","selectionStart","selection","concat","_this","renderTimeLabels","labels","createElement","dates","forEach","time","push","toString","timeFormat","renderDateColumn","dayOfTimes","dateFormat","map","renderDateCellWrapper","startHandler","handleSelectionStartEvent","Boolean","selectionDraft","find","a","className","role","toISOString","onMouseDown","onMouseEnter","handleMouseEnterEvent","onMouseUp","handleMouseUpEvent","onTouchStart","onTouchMove","handleTouchMoveEvent","onTouchEnd","handleTouchEndEvent","renderDateCell","refSetter","dateCell","cellToDate","set","ref","startTime","startDate","Map","minutesInChunk","Math","floor","hourlyChunks","d","numDays","currentDay","h","minTime","maxTime","c","selectionType","isTouchDragging","selectionSchemeHandlers","linear","square","endSelection","bind","componentDidMount","document","addEventListener","passive","componentWillUnmount","removeEventListener","getTimeFromTouchEvent","event","touches","length","_touches$","clientX","clientY","targetElement","elementFromPoint","cellTime","get","onChange","setState","updateAvailabilityDraft","selectionEnd","callback","_state","newSelection","selectionScheme","nextDraft","Array","from","Set","filter","b","timeSelected","_this2","render","_this3","el","gridRef","Component","defaultProps","Date","blue","paleBlue","lightBlue"],"mappings":"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","sourcesContent":["'use strict';\n\nexports.__esModule = true;\nexports.preventScroll = exports.GridCell = undefined;\n\nvar _react = require('react');\n\nvar React = _interopRequireWildcard(_react);\n\nvar _styledComponents = require('styled-components');\n\nvar _styledComponents2 = _interopRequireDefault(_styledComponents);\n\nvar _add_minutes = require('date-fns/add_minutes');\n\nvar _add_minutes2 = _interopRequireDefault(_add_minutes);\n\nvar _add_hours = require('date-fns/add_hours');\n\nvar _add_hours2 = _interopRequireDefault(_add_hours);\n\nvar _add_days = require('date-fns/add_days');\n\nvar _add_days2 = _interopRequireDefault(_add_days);\n\nvar _start_of_day = require('date-fns/start_of_day');\n\nvar _start_of_day2 = _interopRequireDefault(_start_of_day);\n\nvar _is_same_minute = require('date-fns/is_same_minute');\n\nvar _is_same_minute2 = _interopRequireDefault(_is_same_minute);\n\nvar _format = require('date-fns/format');\n\nvar _format2 = _interopRequireDefault(_format);\n\nvar _typography = require('./typography');\n\nvar _colors = require('./colors');\n\nvar _colors2 = _interopRequireDefault(_colors);\n\nvar _selectionSchemes = require('./selection-schemes');\n\nvar _selectionSchemes2 = _interopRequireDefault(_selectionSchemes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n// Import only the methods we need from date-fns in order to keep build size small\n\n\nvar Wrapper = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__Wrapper',\n  componentId: 'sc-10qe3m2-0'\n})(['display:flex;align-items:center;width:100%;user-select:none;']);\n\nvar Grid = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__Grid',\n  componentId: 'sc-10qe3m2-1'\n})(['display:flex;flex-direction:row;align-items:stretch;width:100%;']);\n\nvar Column = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__Column',\n  componentId: 'sc-10qe3m2-2'\n})(['display:flex;flex-direction:column;justify-content:space-evenly;flex-grow:1;']);\n\nvar GridCell = exports.GridCell = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__GridCell',\n  componentId: 'sc-10qe3m2-3'\n})(['margin:', 'px;touch-action:none;'], function (props) {\n  return props.margin;\n});\n\nvar DateCell = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__DateCell',\n  componentId: 'sc-10qe3m2-4'\n})(['width:100%;height:25px;background-color:', ';&:hover{background-color:', ';}'], function (props) {\n  return props.selected ? props.selectedColor : props.unselectedColor;\n}, function (props) {\n  return props.hoveredColor;\n});\n\nvar DateLabel = (0, _styledComponents2.default)(_typography.Subtitle).withConfig({\n  displayName: 'ScheduleSelector__DateLabel',\n  componentId: 'sc-10qe3m2-5'\n})(['height:30px;@media (max-width:699px){font-size:12px;}']);\n\nvar TimeLabelCell = _styledComponents2.default.div.withConfig({\n  displayName: 'ScheduleSelector__TimeLabelCell',\n  componentId: 'sc-10qe3m2-6'\n})(['position:relative;display:block;width:100%;height:25px;margin:3px 0;text-align:center;display:flex;justify-content:center;align-items:center;']);\n\nvar TimeText = (0, _styledComponents2.default)(_typography.Text).withConfig({\n  displayName: 'ScheduleSelector__TimeText',\n  componentId: 'sc-10qe3m2-7'\n})(['margin:0;@media (max-width:699px){font-size:10px;}text-align:right;']);\n\nvar preventScroll = exports.preventScroll = function preventScroll(e) {\n  e.preventDefault();\n};\n\nvar ScheduleSelector = function (_React$Component) {\n  _inherits(ScheduleSelector, _React$Component);\n\n  ScheduleSelector.getDerivedStateFromProps = function getDerivedStateFromProps(props, state) {\n    // As long as the user isn't in the process of selecting, allow prop changes to re-populate selection state\n    if (state.selectionStart == null) {\n      return {\n        selection: [].concat(props.selection)\n      };\n    }\n    return null;\n  };\n\n  function ScheduleSelector(props) {\n    _classCallCheck(this, ScheduleSelector);\n\n    // Generate list of dates to render cells for\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _this.renderTimeLabels = function () {\n      var labels = [React.createElement(DateLabel, { key: -1 })]; // Ensures time labels start at correct location\n      _this.dates[0].forEach(function (time) {\n        labels.push(React.createElement(\n          TimeLabelCell,\n          { key: time.toString() },\n          React.createElement(\n            TimeText,\n            null,\n            (0, _format2.default)(time, _this.props.timeFormat)\n          )\n        ));\n      });\n      return React.createElement(\n        Column,\n        { margin: _this.props.margin },\n        labels\n      );\n    };\n\n    _this.renderDateColumn = function (dayOfTimes) {\n      return React.createElement(\n        Column,\n        { key: dayOfTimes[0].toString(), margin: _this.props.margin },\n        React.createElement(\n          GridCell,\n          { margin: _this.props.margin },\n          React.createElement(\n            DateLabel,\n            null,\n            (0, _format2.default)(dayOfTimes[0], _this.props.dateFormat)\n          )\n        ),\n        dayOfTimes.map(function (time) {\n          return _this.renderDateCellWrapper(time);\n        })\n      );\n    };\n\n    _this.renderDateCellWrapper = function (time) {\n      var startHandler = function startHandler() {\n        _this.handleSelectionStartEvent(time);\n      };\n\n      var selected = Boolean(_this.state.selectionDraft.find(function (a) {\n        return (0, _is_same_minute2.default)(a, time);\n      }));\n\n      return React.createElement(\n        GridCell,\n        {\n          className: 'rgdp__grid-cell',\n          role: 'presentation',\n          margin: _this.props.margin,\n          key: time.toISOString()\n          // Mouse handlers\n          , onMouseDown: startHandler,\n          onMouseEnter: function onMouseEnter() {\n            _this.handleMouseEnterEvent(time);\n          },\n          onMouseUp: function onMouseUp() {\n            _this.handleMouseUpEvent(time);\n          }\n          // Touch handlers\n          // Since touch events fire on the event where the touch-drag started, there's no point in passing\n          // in the time parameter, instead these handlers will do their job using the default SyntheticEvent\n          // parameters\n          , onTouchStart: startHandler,\n          onTouchMove: _this.handleTouchMoveEvent,\n          onTouchEnd: _this.handleTouchEndEvent\n        },\n        _this.renderDateCell(time, selected)\n      );\n    };\n\n    _this.renderDateCell = function (time, selected) {\n      var refSetter = function refSetter(dateCell) {\n        if (dateCell) {\n          _this.cellToDate.set(dateCell, time);\n        }\n      };\n      if (_this.props.renderDateCell) {\n        return _this.props.renderDateCell(time, selected, refSetter);\n      } else {\n        return React.createElement(DateCell, {\n          selected: selected,\n          ref: refSetter,\n          selectedColor: _this.props.selectedColor,\n          unselectedColor: _this.props.unselectedColor,\n          hoveredColor: _this.props.hoveredColor\n        });\n      }\n    };\n\n    var startTime = (0, _start_of_day2.default)(props.startDate);\n    _this.dates = [];\n    _this.cellToDate = new Map();\n    var minutesInChunk = Math.floor(60 / props.hourlyChunks);\n    for (var d = 0; d < props.numDays; d += 1) {\n      var currentDay = [];\n      for (var h = props.minTime; h < props.maxTime; h += 1) {\n        for (var c = 0; c < props.hourlyChunks; c += 1) {\n          currentDay.push((0, _add_minutes2.default)((0, _add_hours2.default)((0, _add_days2.default)(startTime, d), h), c * minutesInChunk));\n        }\n      }\n      _this.dates.push(currentDay);\n    }\n\n    _this.state = {\n      selectionDraft: [].concat(_this.props.selection), // copy it over\n      selectionType: null,\n      selectionStart: null,\n      isTouchDragging: false\n    };\n\n    _this.selectionSchemeHandlers = {\n      linear: _selectionSchemes2.default.linear,\n      square: _selectionSchemes2.default.square\n    };\n\n    _this.endSelection = _this.endSelection.bind(_this);\n    _this.handleMouseUpEvent = _this.handleMouseUpEvent.bind(_this);\n    _this.handleMouseEnterEvent = _this.handleMouseEnterEvent.bind(_this);\n    _this.handleTouchMoveEvent = _this.handleTouchMoveEvent.bind(_this);\n    _this.handleTouchEndEvent = _this.handleTouchEndEvent.bind(_this);\n    _this.handleSelectionStartEvent = _this.handleSelectionStartEvent.bind(_this);\n    return _this;\n  }\n\n  ScheduleSelector.prototype.componentDidMount = function componentDidMount() {\n    // We need to add the endSelection event listener to the document itself in order\n    // to catch the cases where the users ends their mouse-click somewhere besides\n    // the date cells (in which case none of the DateCell's onMouseUp handlers would fire)\n    //\n    // This isn't necessary for touch events since the `touchend` event fires on\n    // the element where the touch/drag started so it's always caught.\n    document.addEventListener('mouseup', this.endSelection);\n\n    // Prevent page scrolling when user is dragging on the date cells\n    this.cellToDate.forEach(function (value, dateCell) {\n      if (dateCell && dateCell.addEventListener) {\n        dateCell.addEventListener('touchmove', preventScroll, { passive: false });\n      }\n    });\n  };\n\n  ScheduleSelector.prototype.componentWillUnmount = function componentWillUnmount() {\n    document.removeEventListener('mouseup', this.endSelection);\n    this.cellToDate.forEach(function (value, dateCell) {\n      if (dateCell && dateCell.removeEventListener) {\n        dateCell.removeEventListener('touchmove', preventScroll);\n      }\n    });\n  };\n\n  // Performs a lookup into this.cellToDate to retrieve the Date that corresponds to\n  // the cell where this touch event is right now. Note that this method will only work\n  // if the event is a `touchmove` event since it's the only one that has a `touches` list.\n\n\n  ScheduleSelector.prototype.getTimeFromTouchEvent = function getTimeFromTouchEvent(event) {\n    var touches = event.touches;\n\n    if (!touches || touches.length === 0) return null;\n    var _touches$ = touches[0],\n        clientX = _touches$.clientX,\n        clientY = _touches$.clientY;\n\n    var targetElement = document.elementFromPoint(clientX, clientY);\n    if (targetElement) {\n      var cellTime = this.cellToDate.get(targetElement);\n      return cellTime;\n    }\n    return null;\n  };\n\n  ScheduleSelector.prototype.endSelection = function endSelection() {\n    this.props.onChange(this.state.selectionDraft);\n    this.setState({\n      selectionType: null,\n      selectionStart: null\n    });\n  };\n\n  // Given an ending Date, determines all the dates that should be selected in this draft\n\n\n  ScheduleSelector.prototype.updateAvailabilityDraft = function updateAvailabilityDraft(selectionEnd, callback) {\n    var _state = this.state,\n        selectionType = _state.selectionType,\n        selectionStart = _state.selectionStart;\n\n\n    if (selectionType === null || selectionStart === null) return;\n\n    var newSelection = [];\n    if (selectionStart && selectionEnd && selectionType) {\n      newSelection = this.selectionSchemeHandlers[this.props.selectionScheme](selectionStart, selectionEnd, this.dates);\n    }\n\n    var nextDraft = [].concat(this.props.selection);\n    if (selectionType === 'add') {\n      nextDraft = Array.from(new Set([].concat(nextDraft, newSelection)));\n    } else if (selectionType === 'remove') {\n      nextDraft = nextDraft.filter(function (a) {\n        return !newSelection.find(function (b) {\n          return (0, _is_same_minute2.default)(a, b);\n        });\n      });\n    }\n\n    this.setState({ selectionDraft: nextDraft }, callback);\n  };\n\n  // Isomorphic (mouse and touch) handler since starting a selection works the same way for both classes of user input\n\n\n  ScheduleSelector.prototype.handleSelectionStartEvent = function handleSelectionStartEvent(startTime) {\n    // Check if the startTime cell is selected/unselected to determine if this drag-select should\n    // add values or remove values\n    var timeSelected = this.props.selection.find(function (a) {\n      return (0, _is_same_minute2.default)(a, startTime);\n    });\n    this.setState({\n      selectionType: timeSelected ? 'remove' : 'add',\n      selectionStart: startTime\n    });\n  };\n\n  ScheduleSelector.prototype.handleMouseEnterEvent = function handleMouseEnterEvent(time) {\n    // Need to update selection draft on mouseup as well in order to catch the cases\n    // where the user just clicks on a single cell (because no mouseenter events fire\n    // in this scenario)\n    this.updateAvailabilityDraft(time);\n  };\n\n  ScheduleSelector.prototype.handleMouseUpEvent = function handleMouseUpEvent(time) {\n    this.updateAvailabilityDraft(time);\n    // Don't call this.endSelection() here because the document mouseup handler will do it\n  };\n\n  ScheduleSelector.prototype.handleTouchMoveEvent = function handleTouchMoveEvent(event) {\n    this.setState({ isTouchDragging: true });\n    var cellTime = this.getTimeFromTouchEvent(event);\n    if (cellTime) {\n      this.updateAvailabilityDraft(cellTime);\n    }\n  };\n\n  ScheduleSelector.prototype.handleTouchEndEvent = function handleTouchEndEvent() {\n    var _this2 = this;\n\n    if (!this.state.isTouchDragging) {\n      // Going down this branch means the user tapped but didn't drag -- which\n      // means the availability draft hasn't yet been updated (since\n      // handleTouchMoveEvent was never called) so we need to do it now\n      this.updateAvailabilityDraft(null, function () {\n        _this2.endSelection();\n      });\n    } else {\n      this.endSelection();\n    }\n    this.setState({ isTouchDragging: false });\n  };\n\n  ScheduleSelector.prototype.render = function render() {\n    var _this3 = this;\n\n    return React.createElement(\n      Wrapper,\n      null,\n      React.createElement(\n        Grid,\n        {\n          ref: function ref(el) {\n            _this3.gridRef = el;\n          }\n        },\n        this.renderTimeLabels(),\n        this.dates.map(this.renderDateColumn)\n      )\n    );\n  };\n\n  return ScheduleSelector;\n}(React.Component);\n\nScheduleSelector.defaultProps = {\n  selection: [],\n  selectionScheme: 'square',\n  numDays: 7,\n  minTime: 9,\n  maxTime: 23,\n  hourlyChunks: 1,\n  startDate: new Date(),\n  timeFormat: 'ha',\n  dateFormat: 'M/D',\n  margin: 3,\n  selectedColor: _colors2.default.blue,\n  unselectedColor: _colors2.default.paleBlue,\n  hoveredColor: _colors2.default.lightBlue,\n  onChange: function onChange() {}\n};\nexports.default = ScheduleSelector;"]},"metadata":{},"sourceType":"script"}